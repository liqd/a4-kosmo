{% load i18n static thumbnail %}

{% if request.user.is_authenticated %}
    <div class="dropdown dropdown--right userindicator__dropdown">
        <button
                type="button"
                class="dropdown-toggle btn btn--bg-tertiary btn--square btn--align-left"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
                id="user-actions"
        >
            <img class="userindicator__btn-img" src="{% if request.user.avatar %}{{ request.user.avatar|thumbnail_url:'avatar'}}{% else %}{% static 'images/avatar_00.png' %}{% endif %}">
            <div class="userindicator__btn-text">
                <span class="userindicator__hello">{% trans "Hello" %}</span>
                <br>
                <span>{{ request.user.username }}</span>
            </div>
            <i class="fa fa-angle-down" aria-hidden="true"></i>
        </button>
        <ul class="dropdown-menu userindicator__dropdown-menu" aria-labelledby="user-actions">
            <li>
                <a class="dropdown-item" href="{% url 'account' %}">{% trans "Account Settings" %}</a>
            </li>

            {% for organisation in request.user.organisations %}

            <li>
                <a class="dropdown-item" href="{% url 'a4dashboard:project-list' organisation_slug=organisation.slug %}">
                    {{ organisation.name }}
                </a>
            </li>

            {% endfor %}

            <li>
                <form class="form--inline" action="{% url 'account_logout' %}" method="post" aria-label="{% trans 'Logout' %}">
                    {% csrf_token %}
                    <input type="hidden" name="next" value="{{ redirect_field_value }}">
                    <button type="submit" class="dropdown-item">{% trans "Logout" %}</button>
                </form>
            </li>
        </ul>
    </div>
{% else %}
    <ul class="navi__list">
        <li class="navi__item">
            <a class="navi__link" href="{% url 'account_login' %}?next={{ redirect_field_value }}">{% trans "Login" %}</a>
        </li>
        <li class="navi__item">
            <a class="navi__link" href="{% url 'account_signup' %}?next={{ redirect_field_value }}">{% trans "Register" %}</a>
        </li>
    </ul>
{% endif %}

